//
//  ESEventHandler.h
//  X-Monitor
//
//  Created by lyq1996 on 2023/4/22.
//

#ifndef ESEventHandler_h
#define ESEventHandler_h

#import "Event.h"
#import <EndpointSecurity/EndpointSecurity.h>
#import <Foundation/Foundation.h>

NS_ASSUME_NONNULL_BEGIN

@interface BaseEventHandler : NSObject

- (Event *)handleEvent:(const es_message_t *)msg;

@end

#define DECLARE_EVENT_HANDLER_CLASS(name) \
    @interface EventHandler_##name : BaseEventHandler \
    @end

DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_EXEC)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_OPEN)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_KEXTLOAD)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_MMAP)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_MPROTECT)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_MOUNT)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_RENAME)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_SIGNAL)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_UNLINK)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_EXEC)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_OPEN)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_FORK)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_CLOSE)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_CREATE)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_EXCHANGEDATA)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_EXIT)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_GET_TASK)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_KEXTLOAD)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_KEXTUNLOAD)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_LINK)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_MMAP)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_MPROTECT)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_MOUNT)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_UNMOUNT)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_IOKIT_OPEN)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_RENAME)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_SETATTRLIST)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_SETEXTATTR)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_SETFLAGS)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_SETMODE)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_SETOWNER)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_SIGNAL)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_UNLINK)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_WRITE)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_FILE_PROVIDER_MATERIALIZE)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_FILE_PROVIDER_MATERIALIZE)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_FILE_PROVIDER_UPDATE)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_FILE_PROVIDER_UPDATE)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_READLINK)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_READLINK)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_TRUNCATE)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_TRUNCATE)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_LINK)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_LOOKUP)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_CREATE)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_SETATTRLIST)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_SETEXTATTR)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_SETFLAGS)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_SETMODE)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_SETOWNER)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_CHDIR)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_CHDIR)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_GETATTRLIST)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_GETATTRLIST)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_STAT)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_ACCESS)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_CHROOT)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_CHROOT)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_UTIMES)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_UTIMES)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_CLONE)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_CLONE)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_FCNTL)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_GETEXTATTR)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_GETEXTATTR)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_LISTEXTATTR)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_LISTEXTATTR)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_READDIR)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_READDIR)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_DELETEEXTATTR)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_DELETEEXTATTR)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_FSGETPATH)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_FSGETPATH)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_DUP)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_SETTIME)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_SETTIME)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_UIPC_BIND)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_UIPC_BIND)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_UIPC_CONNECT)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_UIPC_CONNECT)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_EXCHANGEDATA)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_SETACL)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_SETACL)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_PTY_GRANT)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_PTY_CLOSE)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_PROC_CHECK)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_PROC_CHECK)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_GET_TASK)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_SEARCHFS)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_SEARCHFS)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_FCNTL)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_IOKIT_OPEN)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_PROC_SUSPEND_RESUME)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_PROC_SUSPEND_RESUME)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_CS_INVALIDATED)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_GET_TASK_NAME)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_TRACE)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_REMOTE_THREAD_CREATE)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_REMOUNT)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_REMOUNT)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_GET_TASK_READ)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_GET_TASK_READ)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_GET_TASK_INSPECT)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_SETUID)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_SETGID)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_SETEUID)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_SETEGID)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_SETREUID)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_SETREGID)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_AUTH_COPYFILE)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_COPYFILE)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_AUTHENTICATION)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_XP_MALWARE_DETECTED)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_XP_MALWARE_REMEDIATED)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_LW_SESSION_LOGIN)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_LW_SESSION_LOGOUT)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_LW_SESSION_LOCK)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_LW_SESSION_UNLOCK)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_SCREENSHARING_ATTACH)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_SCREENSHARING_DETACH)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_OPENSSH_LOGIN)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_OPENSSH_LOGOUT)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_LOGIN_LOGIN)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_LOGIN_LOGOUT)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_BTM_LAUNCH_ITEM_ADD)
DECLARE_EVENT_HANDLER_CLASS(ES_EVENT_TYPE_NOTIFY_BTM_LAUNCH_ITEM_REMOVE)

NS_ASSUME_NONNULL_END

#endif /* ESEventHandler_h */
